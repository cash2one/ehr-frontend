define(["require","../app","module/config","moment"],function(e){var t=e("../app"),n=e("module/config"),r=e("moment");t.controller("hrMonthSalaryCtrl",["$scope","hrRequest","$stateParams","localStorage","$state","authUtil","hrUtil","hrUtil","bigDecimal","$sce",function(e,t,n,i,s,o,u,u,a,f){function m(){g(),y(),b(),e.onMonthChange=w}function g(){e.monthMin="2015-11"}function y(){var t=new Date,n=t.getDate();n>=10?e.monthMax=r().add(-1,"M").format("YYYY-MM"):e.monthMax=r().add(-2,"M").format("YYYY-MM"),e.query.month=new Date(e.monthMax+"-01 00:00:00")}function b(){if(e.monthSalaryForm&&!e.monthSalaryForm.$valid){alert("请输入正确查询月份"),e.query.month=l;return}l=e.query.month,t.getMonthSalary({number:i.get("number"),month:r(e.query.month.getTime()).format("YYYY-MM")}).then(function(e){E(e.data)})}function w(){b()}function E(t){e.abtainSalary=[],e.minusSalary=[],t||(t={}),e.realSum=v(t.realSum,t.yearAwardFinal),e.sumSalary=v(t.sumSalary,t.yearAward),e.sumMinusPer=v(t.sumMinusPer,t.yearAwardTax),e.detail=t.detail,e.yearAwardTax=t.yearAwardTax,e.systemMemo=t.systemMemo,t.performDetail!="[]"&&t.performDetail&&(e.performDetail=f.trustAsHtml(u.getPerformSalaryHtml(JSON.parse(t.performDetail),t.performSalary)));for(var n=0,r;r=c[n++];){var i=t[r];i&&e.abtainSalary.push({name:h[r],value:i})}for(var n=0,r;r=p[n++];){var i=t[r];e.minusSalary.push({name:d[r],value:i})}}e.abtainSalary=[],e.minusSalary=[],e.query={};var l={},c=["executeSalary","trafficSubsidy","mobileSubsidy","mealSubsidy","performSalary","mealPlus","recommend","houseSubsidy","specialReward","otherSubsidy","yearAward"],h={executeSalary:"本月基本工资",trafficSubsidy:"交通补贴",mobileSubsidy:"通讯补贴",mealSubsidy:"餐补",performSalary:"绩效工资",mealPlus:"补充餐补",recommend:"推荐费用",houseSubsidy:"住房补贴",specialReward:"分公司经理特别奖",otherSubsidy:"其它补贴",yearAward:"年终奖"},p=["endowPer","unemployPer","medicalPer","injuryPer","maternityPer","houseFundPer","personTax"],d={endowPer:"代扣养老保险",unemployPer:"代扣失业保险",medicalPer:"代扣医疗保险",injuryPer:"代扣工伤保险",maternityPer:"代扣生育保险",houseFundPer:"代扣公积金",personTax:"代扣个税"},v=a.add;m()}])});