define(["require","../app","module/config","module/codeConfig","module/nameConfig","../config","./colsConfig","moment"],function(e){function a(e,t,r,i,s,a,f,l){function c(){e.onSearch=h,e.tableOptions={data:[],canSelect:!0,totalCount:0,cols:o(e),pageSize:n.PAGE_SIZE,onPageChange:function(t){e.currentPage=t,d()},selectedItems:[]},e.getList=d;var t=u().add(-1,"M").format("YYYY-MM");e.monthMax=t,e.query.month=new Date(t+" 00:00:00"),v()}function h(){d()}function p(e){for(var t=0,n;n=e[t++];);return e}function d(){if(!e.query.month){alert("请输入查询月份");return}var r={pageDto:{pageNum:e.currentPage||1,pageSize:n.PAGE_SIZE},structure:e.query.structure,month:u(e.query.month.getTime()).format("YYYY-MM")};t.getTaxList(r).then(function(t){e.tableOptions.data=p(t.data),e.tableOptions.totalCount=t.pageDto&&t.pageDto.count||0}),e.exportUrl=m(r)}function v(){l.getStructure().then(function(t){e.structureList=s.getSalaryNode(t.data,e),e.query.structure=e.structureList[0].id,d()})}function m(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&n!="pageDto"&&t.push(n+"="+e[n]);return"EXPORT/staff/taxList.json?"+t.join("&")}e.currentPage=1,e.query={},c()}var t=e("../app"),n=e("module/config"),r=e("module/codeConfig"),i=e("module/nameConfig"),s=e("../config"),o=e("./colsConfig"),u=e("moment");t.controller("hrTaxListController",a),a.$inject=["$scope","hrRequest","$state","hrUtil","util","hrOptUtil","adminUtil","adminRequest"]});