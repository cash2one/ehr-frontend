define(["require","../app","./options","module/config","module/codeConfig"],function(e){var t=e("../app"),n=e("./options"),r=e("module/config"),i=e("module/codeConfig"),s=i.STAFF_STATUS_CODE;t.controller("hrDimissionCtrl",["$scope","hrRequest","$stateParams","localStorage","hrUtil",function(e,t,r,i,o){function a(){e.canEditLeaveInfo=!1,o.initEntryHRType(e),e.isFromRelationshipHR&&(e.canEditLeaveInfo=!0),e.canEditLeaveInfo||e.disbaleLeaveInput(),e.getLeaveInfo()}e.number=i.get("number");var u="leaveJobForm";e.inputOptions=n(u),e.ok=function(n){if(!n.$valid)return;var r=e.reason.split("-"),i={number:e.number,leaveSignBill:e.leaveSignBill,leaveDate:e.leaveDate.getTime()};if(e.reasonFromHr){var o=e.reasonFromHr.split("-");i.reasonFromHr=o[0],i.detailReasonFromHr=o[1]}t.leaveJob(i).then(function(t){info("操作成功"),e.commonInfo.status=s.LEAVED})},e.disbaleLeaveInput=function(){o.disableOptions(e.inputOptions)},e.getLeaveInfo=function(){t.getLeaveInfo({number:e.number}).then(function(t){if(t.data){var n=t.data;$.extend(!0,e,n),e.leaveDate=n.leaveDate&&new Date(n.leaveDate),e.leaveDetail=n.detail,n.reason&&(e.reason=o.getLeaveReasonName(n.reason,n.detailReason)),n.reasonFromHr&&(e.reasonFromHr=n.reasonFromHr+"-"+n.detailReasonFromHr,e.inputOptions.reasonFromHr.displayValue=o.getLeaveReasonName(n.reasonFromHr,n.detailReasonFromHr)),e.inputOptions.leaveSignBill.fileUrl=n.leaveSignBillFile}})},a()}])});