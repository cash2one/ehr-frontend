define(["require","../../app","module/config"],function(e){var t=e("../../app"),n=e("module/config");t.directive("educationInfo",["ajaxService","hrRequest",function(e,t){return{restrict:"EA",scope:{options:"="},require:"?ngModel",templateUrl:"src/module/hr/directive/educationInfo/tpl.html",replace:!1,compile:function(e,r,i,s){return{pre:function(e,t,r,i){var s="educationForm";e.inputOptions={start:{required:!0,displayName:"开始时间",name:"start",formName:s,type:"month"},end:{required:!0,displayName:"结束时间",name:"end",formName:s,type:"month"},school:{required:!0,displayName:"学校",name:"school",formName:s,maxLength:15,placeholder:"少于15个字"},discipline:{required:!0,displayName:"专业",name:"discipline",formName:s,maxLength:15,placeholder:"少于15个字"},degree:{required:!0,displayName:"学历",name:"degree",formName:s,mode:"select",items:n.DEGREE}}},post:function(e,n,r,i){function s(){e.editInfo={startShow:undefined,endShow:undefined,school:undefined,discipline:undefined,degree:undefined}}function o(){e.editInfo={start:e.start,end:e.end,school:e.school,discipline:e.discipline,degree:e.degree}}e.onDel=function(){confirm("确认删除该条信息吗？",function(){t.delEducationExperience({id:e.id}).then(function(t){info("删除成功");if(e.$parent.$parent.eduExperList&&e.$parent.$parent.eduExperienceId){var r=0;e.$parent.$parent.eduExpList.indexOf(e.id)!==-1&&(r=e.$parent.$parent.eduExpList.indexOf(e.id),e.$parent.$parent.eduExpList.splice(r,1)),e.$parent.$parent.eduExperienceId.indexOf(e.id)!==-1&&(r=e.$parent.$parent.eduExperienceId.indexOf(e.id),e.$parent.$parent.eduExperienceId.splice(r,1))}i.$setViewValue({}),$(n).html("")})})},e.onEditSave=function(n){n.$submitted=!0;if(!n.$valid)return;var r=e.editInfo.start.getTime(),s=e.editInfo.end.getTime();if(r>s){alert("结束时间必须大于开始时间");return}var o={id:e.id,start:r,end:s,school:e.editInfo.school,discipline:e.editInfo.discipline,degree:e.editInfo.degree};t.modEducationExperience(o).then(function(t){info("修改成功"),e.editing=!1,e.start=e.editInfo.start,e.end=e.editInfo.end,e.startShow=e.formatMonth(e.editInfo.start),e.endShow=e.formatMonth(e.editInfo.end),e.school=e.editInfo.school,e.discipline=e.editInfo.discipline,e.degree=e.editInfo.degree,i.$setViewValue(o)})},e.onEdit=function(){e.editing=!0,o()},e.onCancelEdit=function(){e.editing=!1,s()},e.formatMonth=function(e){return e.getFullYear()+"-"+(e.getMonth()+1)},i.$formatters.push(function(e){return e}),i.$parsers.push(function(e){return e}),i.$render=function(){e.id=i.$viewValue.id,e.start=i.$viewValue.start,e.end=i.$viewValue.end,e.school=i.$viewValue.school,e.discipline=i.$viewValue.discipline,e.degree=i.$viewValue.degree,e.disable=i.$viewValue.disable,e.startShow=e.formatMonth(e.start),e.endShow=e.formatMonth(e.end)}}}}}}])});