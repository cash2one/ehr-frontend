define(["require","../../app","./inputOptions","module/config","../../config","module/codeConfig","moment"],function(e){function a(e,t,r,u,a,f,l){function h(){}function p(t){if(!t.$valid)return;a.diffDaysFromNow(e.leaveDate,"days")<i.EXECUTE_TIP_DAYS?confirm(i.LEAVE_EXECUTE_TIP,function(){d()}):d()}function d(){var n=e.reason.split("-"),r=o().format("YYYY-MM-DD"),a=(new Date(r+" 00:00:00")).getTime(),f=e.leaveDate.getTime();a==f&&(f=o(r).add(1,"days").valueOf()-1e3);var l={number:e.number,reason:+n[0],detailReason:+n[1],detail:e.detail,leaveDate:f},h=s.APPLY_CODE.LEAVE;e.isAgent&&(h=s.APPLY_CODE.AGENT_LEAVE),t.addApply({editedNumber:e.userCommonInfo.number,type:h,content:l,executeDate:l.leaveDate}).then(function(){alert(i.SUCCESS_TIP),c.hadSuccess=!0,u.dismiss(c)})}function v(){u.dismiss(c)}e.number=r.get("number"),e.save=p,e.closeHandler=v,e.inputOptions=n("leaveForm",e);var c={};h()}var t=e("../../app"),n=e("./inputOptions"),r=e("module/config"),i=e("../../config"),s=e("module/codeConfig"),o=e("moment"),u={};t.controller("applyOptLeaveCtrl",a),a.$inject=["$scope","applyRequest","localStorage","$modalInstance","util","hrRequest","hrUtil"]});