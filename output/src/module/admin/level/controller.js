define(["require","../app","module/config","module/codeConfig","moment","./mod/controller","./levelOptions"],function(e){function s(t,n,r,i,s){function o(){u()}function u(){r.getLevelTemplate().then(function(e){t.tableOptions.data=e.data;if(typeof t.tid=="undefined"){var n=e.data[0];t.tid=n.id,t.curName=n.name,f()}})}function a(e,t){f()}function f(){var e={templateId:t.tid,type:t.type};r.getLevel(e).then(function(e){t.levelList=e.data})}function l(e){t.tid=e.id,t.curName=e.name,f()}function c(e){var n=s.open({templateUrl:"src/module/admin/level/mod/tpl.html",controller:"levelModCtrl",resolve:{item:function(){return e},optType:function(){return"mod"}}});n.result.then(function(){},function(e){e.hasSuccess==1&&(u(),t.tid==e.id&&(t.curName=e.name))})}function h(e){var t=s.open({templateUrl:"src/module/admin/level/mod/tpl.html",controller:"levelModCtrl",resolve:{item:function(){return e},optType:function(){return"add"}}});t.result.then(function(){},function(e){e.hasSuccess==1&&u()})}t.levelOptions=e("./levelOptions")("levelAddForm"),t.type="M",t.types=[{key:"M",value:"M序列"},{key:"T",value:"T序列"},{key:"P",value:"P序列"},{key:"U",value:"U序列"},{key:"A",value:"A序列"}],t.typeChangeHandler=a,t.nameClick=l,t.modifyClick=c,t.add=h,t.lid=undefined,t.tableOptions={data:[],canSelect:!1,mainScope:t,cols:[{field:"name",displayName:"模板名称",cellTpl:"src/module/admin/level/tableTpl/name.html"},{field:"opt",displayName:"操作",cellTpl:"src/module/admin/level/tableTpl/opt.html"}]},t.levelAdd={addClick:function(){t.addingLevel=!0},onCancel:function(){var e=this;t.addingLevel=!1,e.clearInfo()},clearInfo:function(){t.levelAdd.level=undefined,t.levelAdd.levelName=undefined},onSave:function(e){e.$submitted=!0;var n=this;if(!e.$valid)return;r.addLevel({type:t.type,level:t.levelAdd.level,levelName:t.levelAdd.levelName,templateId:t.tid}).then(function(r){info("添加成功"),t.addingLevel=!1,f(),e.$submitted=!1,n.clearInfo()})}},o()}var t=e("../app"),n=e("module/config"),r=e("module/codeConfig"),i=e("moment");e("./mod/controller"),t.controller("adminLevelControllor",s),s.$inject=["$scope","$stateParams","adminRequest","hrRequest","$modal"]});