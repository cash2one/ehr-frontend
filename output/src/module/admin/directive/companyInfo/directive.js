define(["require","../../app","module/config"],function(e){var t=e("../../app"),n=e("module/config");t.directive("companyInfo",["ajaxService","adminRequest","hrRequest",function(e,t,n){return{restrict:"EA",scope:{options:"="},require:"?ngModel",templateUrl:"src/module/admin/directive/companyInfo/tpl.html",replace:!1,link:function(e,t,r,i){e.departmentsSelectOptions={items:[]},e.onDel=function(){confirm("确认删除该条信息吗？")&&(e.options.companyId=undefined,$(t).html("")),confirm("确认删除该条信息吗？",function(){e.options.companyId=undefined,$(t).html("")})},e.onEditSave=function(t){if(!t.$valid)return;e.options.companyName=e.getCompanyName(e.options.companyId),e.options.departmentNames=e.getDepartmentNames(e.options.departmentIds),e.editing=!1},e.getCompanyName=function(t){for(var n=0,r;r=e.companys[n++];)if(r.id==t)return r.name},e.getDepartmentNames=function(t){var n=[],r=e.departmentsSelectOptions.items;for(var i=0,s;s=r[i++];)$.inArray(s.id,t)!=-1&&n.push(s.name);return n.join(",")},e.onEdit=function(){e.editing=!0},e.onCancelEdit=function(){e.editing=!1},e.getCompany=function(){n.getCompany().then(function(t){e.companys=t.data})},e.$watch("options.companyId",function(t,r){n.getDepartment({company:e.options.companyId}).then(function(n){e.departmentsSelectOptions.items=n.data,t!=r&&(e.options.departmentIds=[])})},!0),e.getCompany()}}}])});